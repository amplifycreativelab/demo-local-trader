---
import "../styles/global.css";
import DemoLayout from "./DemoLayout.astro";

interface Props {
    title: string;
    description?: string;
    image?: string;
}

const {
    title,
    description = "Fast & reliable local service concept demo. Licensed, insured, and available for same-day quotes.",
    image = "/placeholder-social.jpg",
} = Astro.props;

const siteTitle = "QuickQuote Home Services";
const phoneDisplay = "amplifycreativelab.com";
const phoneHref = "https://amplifycreativelab.com";

// Helper to handle base URL
const baseUrl = import.meta.env.BASE_URL.endsWith("/")
    ? import.meta.env.BASE_URL
    : `${import.meta.env.BASE_URL}/`;
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/svg+xml" href={`${baseUrl}favicon.svg`} />
        <meta name="generator" content={Astro.generator} />
        <meta name="robots" content="noindex, nofollow" />
        <title>{title} | {siteTitle}</title>
        <meta name="description" content={description} />

        <!-- Open Graph -->
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta
            property="og:image"
            content={image.startsWith("http")
                ? image
                : `${baseUrl}${image.replace(/^\//, "")}`}
        />
        <meta property="og:type" content="website" />

        <!-- Twitter -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        <meta
            name="twitter:image"
            content={image.startsWith("http")
                ? image
                : `${baseUrl}${image.replace(/^\//, "")}`}
        />

        <!-- Sitemap -->
        <link rel="sitemap" href={`${baseUrl}sitemap-index.xml`} />

        <!-- Non-indexed portfolio demo: intentionally no schema -->
    </head>
    <body
        class="flex flex-col min-h-screen text-text-main bg-background font-sans antialiased selection:bg-primary selection:text-white"
    >
        <DemoLayout>
        <a
            href="#main-content"
            class="sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 bg-primary text-white p-4 z-50 rounded font-medium shadow-lg transition-transform"
            >Skip to main content</a
        >

        <!-- Header -->
        <header
            class="bg-white/90 backdrop-blur-md border-b border-gray-200 sticky top-0 z-40"
        >
            <div
                class="container mx-auto px-4 h-16 md:h-20 flex items-center justify-between"
            >
                <a
                    href={baseUrl}
                    class="text-2xl md:text-3xl font-bold text-primary tracking-tight flex items-center gap-2"
                >
                    <span class="text-accent">âš¡</span> QuickQuote
                </a>

                <nav class="hidden md:flex items-center gap-8">
                    <a
                        href={`${baseUrl}services`}
                        class="text-sm font-medium hover:text-primary transition-colors"
                        >Services</a
                    >
                    <a
                        href={`${baseUrl}areas`}
                        class="text-sm font-medium hover:text-primary transition-colors"
                        >Areas</a
                    >
                    <a
                        href={`${baseUrl}about`}
                        class="text-sm font-medium hover:text-primary transition-colors"
                        >About</a
                    >
                    <div
                        class="flex items-center gap-4 ml-4 pl-6 border-l border-gray-200"
                    >
                        <a
                            href={phoneHref}
                            class="font-bold text-primary hover:text-primary-hover flex items-center gap-2 text-lg"
                        >
                            <span>ðŸ“ž</span>
                            {phoneDisplay}
                        </a>
                        <a
                            href={`${baseUrl}contact`}
                            class="bg-primary text-white px-6 py-2.5 rounded-lg font-semibold hover:bg-primary-hover transition-colors shadow-sm transform hover:-translate-y-0.5 active:translate-y-0 duration-200"
                        >
                            Get Quote
                        </a>
                    </div>
                </nav>

                <!-- Mobile Actions -->
                <div class="md:hidden flex items-center gap-2">
                    <a
                        href={`${baseUrl}contact`}
                        class="bg-primary text-white px-4 py-2 rounded-md font-semibold text-sm shadow-sm"
                    >
                        Get Quote
                    </a>
                    <button
                        type="button"
                        id="mobile-menu-button"
                        class="inline-flex items-center justify-center rounded-md p-2 text-text-main hover:bg-gray-100 transition-colors"
                        aria-label="Open menu"
                        aria-controls="mobile-menu"
                        aria-expanded="false"
                    >
                        <svg
                            data-menu-icon="open"
                            class="h-6 w-6"
                            aria-hidden="true"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M4 6h16M4 12h16M4 18h16"
                            />
                        </svg>
                        <svg
                            data-menu-icon="close"
                            class="h-6 w-6 hidden"
                            aria-hidden="true"
                            fill="none"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                            stroke-width="2"
                        >
                            <path
                                stroke-linecap="round"
                                stroke-linejoin="round"
                                d="M6 18L18 6M6 6l12 12"
                            />
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Mobile Menu -->
            <div
                id="mobile-menu"
                class="md:hidden hidden border-t border-gray-200 bg-white/95 backdrop-blur-md"
            >
                <nav
                    class="container mx-auto px-4 py-4 flex flex-col gap-1"
                    aria-label="Mobile"
                >
                    <a
                        href={`${baseUrl}services`}
                        class="block rounded-lg px-3 py-3 font-medium hover:bg-gray-50 transition-colors"
                        >Services</a
                    >
                    <a
                        href={`${baseUrl}areas`}
                        class="block rounded-lg px-3 py-3 font-medium hover:bg-gray-50 transition-colors"
                        >Areas</a
                    >
                    <a
                        href={`${baseUrl}about`}
                        class="block rounded-lg px-3 py-3 font-medium hover:bg-gray-50 transition-colors"
                        >About</a
                    >
                    <a
                        href={`${baseUrl}contact`}
                        class="block rounded-lg px-3 py-3 font-medium hover:bg-gray-50 transition-colors"
                        >Contact</a
                    >
                    <div class="mt-2 pt-3 border-t border-gray-200">
                        <a
                            href={phoneHref}
                            class="flex items-center gap-2 rounded-lg px-3 py-3 font-bold text-primary hover:bg-gray-50 transition-colors"
                        >
                            <span class="text-lg">dY"z</span> {phoneDisplay}
                        </a>
                    </div>
                </nav>
            </div>
        </header>

        <main id="main-content" class="flex-grow">
            <slot />
        </main>

        <!-- Footer -->
        <footer
            class="bg-gray-900 text-white pt-16 pb-8 border-t-4 border-accent"
        >
            <div
                class="container mx-auto px-4 grid md:grid-cols-4 gap-12 text-sm"
            >
                <div>
                    <h3
                        class="text-2xl font-bold mb-6 text-white tracking-tight"
                    >
                        QuickQuote
                    </h3>
                    <p class="text-gray-400 mb-6 leading-relaxed">
                        Fast, reliable, and licensed home services concept demo.
                        Portfolio-only and non-indexed.
                    </p>
                    <div class="space-y-3">
                        <a
                            href={phoneHref}
                            class="block font-bold text-lg hover:text-accent transition-colors"
                            >{phoneDisplay}</a
                        >
                        <p class="text-gray-500">License: #PL99999</p>
                    </div>
                </div>
                <div>
                    <h4
                        class="font-bold mb-6 text-white uppercase tracking-wider text-xs"
                    >
                        Services
                    </h4>
                    <ul class="space-y-3 text-gray-400">
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >Emergency Plumbing</a
                            >
                        </li>
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >Drain Cleaning</a
                            >
                        </li>
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >Hot Water Systems</a
                            >
                        </li>
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >Leak Detection</a
                            >
                        </li>
                    </ul>
                </div>
                <div>
                    <h4
                        class="font-bold mb-6 text-white uppercase tracking-wider text-xs"
                    >
                        Resources
                    </h4>
                    <ul class="space-y-3 text-gray-400">
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >How it works</a
                            >
                        </li>
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >Pricing guide</a
                            >
                        </li>
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >Safety checklist</a
                            >
                        </li>
                        <li>
                            <a
                                href="#"
                                class="hover:text-white transition-colors"
                                >FAQ</a
                            >
                        </li>
                    </ul>
                </div>
                <div>
                    <h4
                        class="font-bold mb-6 text-white uppercase tracking-wider text-xs"
                    >
                        Hours
                    </h4>
                    <ul class="space-y-3 text-gray-400">
                        <li
                            class="flex justify-between border-b border-gray-800 pb-2"
                        >
                            <span>Mon-Fri:</span>
                            <span>7am - 5pm</span>
                        </li>
                        <li
                            class="flex justify-between border-b border-gray-800 pb-2"
                        >
                            <span>Sat:</span>
                            <span>8am - 2pm</span>
                        </li>
                        <li
                            class="flex justify-between text-accent font-bold pt-1"
                        >
                            <span>Emergency:</span>
                            <span>24/7</span>
                        </li>
                    </ul>
                </div>
            </div>
            <div
                class="container mx-auto px-4 mt-12 pt-8 border-t border-gray-800 text-center text-gray-500"
            >
                <p>
                    &copy; {new Date().getFullYear()} QuickQuote Services. All rights
                    reserved. | <a href="#" class="hover:text-white">Privacy</a>
                </p>
            </div>
        </footer>

        <!-- Sticky Mobile Call -->
        <div
            class="md:hidden fixed bottom-6 left-4 right-4 z-50 pointer-events-none"
        >
            <a
                href={phoneHref}
                class="pointer-events-auto bg-accent text-white font-bold text-lg w-full py-4 rounded-xl shadow-[0_8px_30px_rgb(0,0,0,0.3)] flex items-center justify-center gap-3 hover:bg-yellow-600 transition-colors border-2 border-white/20"
            >
                <span class="text-2xl">â“˜</span> Studio Site
            </a>
        </div>

        <script is:inline>
            (function () {
                var button = document.getElementById("mobile-menu-button");
                var menu = document.getElementById("mobile-menu");

                if (!button || !menu) return;
                if (button.getAttribute("data-bound") === "true") return;
                button.setAttribute("data-bound", "true");

                var iconOpen = button.querySelector('[data-menu-icon="open"]');
                var iconClose = button.querySelector('[data-menu-icon="close"]');

                function setOpen(open) {
                    button.setAttribute("aria-expanded", open ? "true" : "false");
                    button.setAttribute("aria-label", open ? "Close menu" : "Open menu");

                    if (open) {
                        menu.classList.remove("hidden");
                        if (iconOpen) iconOpen.classList.add("hidden");
                        if (iconClose) iconClose.classList.remove("hidden");
                    } else {
                        menu.classList.add("hidden");
                        if (iconOpen) iconOpen.classList.remove("hidden");
                        if (iconClose) iconClose.classList.add("hidden");
                    }
                }

                function isOpen() {
                    return button.getAttribute("aria-expanded") === "true";
                }

                button.addEventListener("click", function () {
                    setOpen(!isOpen());
                });

                var links = menu.querySelectorAll("a[href]");
                for (var i = 0; i < links.length; i++) {
                    links[i].addEventListener("click", function () {
                        setOpen(false);
                    });
                }

                document.addEventListener("keydown", function (event) {
                    if (event.key === "Escape" || event.keyCode === 27) setOpen(false);
                });

                document.addEventListener("click", function (event) {
                    if (!isOpen()) return;

                    var target = event.target;
                    if (!target) return;
                    if (button.contains(target) || menu.contains(target)) return;

                    setOpen(false);
                });

                setOpen(false);
            })();
        </script>
        </DemoLayout>
    </body>
</html>
